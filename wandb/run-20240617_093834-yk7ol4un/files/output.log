Freezing layer 'model.22.dfl.conv.weight'
[34m[1mAMP: [39m[22mrunning Automatic Mixed Precision (AMP) checks with YOLOv8n...
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mtrain: [39m[22mScanning /home/ubuntu/文档/GitHub/DL大作业/datasets/content/labels/train.cache... 82085 images, 1706 backgrounds, 0 corrupt: 100%|██████████| 83791/83791 [00:00<?, ?it/s]
[34m[1mval: [39m[22mScanning /home/ubuntu/文档/GitHub/DL大作业/datasets/content/labels/val.cache... 56166 images, 174 backgrounds, 0 corrupt: 100%|██████████| 56340/56340 [00:00<?, ?it/s]
Plotting labels to runs/detect/train103/labels.jpg...
[34m[1moptimizer:[39m[22m Lion(lr=0.01, momentum=0.937) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)
       1/20      2.77G      1.278       3.88       1.13        197        640:   0%|          | 3/5237 [00:01<39:09,  2.23it/s]
[34m[1mTensorBoard: [39m[22mmodel graph visualization added ✅
Image sizes 640 train, 640 val
Using 8 dataloader workers
Logging results to [1mruns/detect/train103
Starting training for 20 epochs...






















       1/20      2.77G      1.239       1.69      1.062        177        640:   3%|▎         | 176/5237 [00:45<21:38,  3.90it/s]
WARNING ⚠️ no model scale passed. Assuming scale='n'.
New https://pypi.org/project/ultralytics/8.2.34 available 😃 Update with 'pip install -U ultralytics'
Ultralytics YOLOv8.2.31 🚀 Python-3.10.14 torch-2.3.1+cu121 CUDA:0 (NVIDIA P102-100, 10150MiB)
[34m[1mengine/trainer: [39m[22mtask=detect, mode=train, model=./yolov8n.pt, data=/home/ubuntu/文档/GitHub/DL大作业/ua-dataset.yaml, epochs=20, time=None, patience=100, batch=16, imgsz=640, save=True, save_period=-1, cache=False, device=None, workers=8, project=None, name=train104, exist_ok=False, pretrained=True, optimizer=Lion, verbose=True, seed=0, deterministic=True, single_cls=False, rect=False, cos_lr=False, close_mosaic=10, resume=False, amp=True, fraction=1.0, profile=False, freeze=None, multi_scale=False, overlap_mask=True, mask_ratio=4, dropout=0.0, val=True, split=val, save_json=False, save_hybrid=False, conf=None, iou=0.7, max_det=300, half=False, dnn=False, plots=True, source=None, vid_stride=1, stream_buffer=False, visualize=False, augment=False, agnostic_nms=False, classes=None, retina_masks=False, embed=None, show=False, save_frames=False, save_txt=False, save_conf=False, save_crop=False, show_labels=True, show_conf=True, show_boxes=True, line_width=None, format=torchscript, keras=False, optimize=False, int8=False, dynamic=False, simplify=False, opset=None, workspace=4, nms=False, lr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=7.5, cls=0.5, dfl=1.5, pose=12.0, kobj=1.0, label_smoothing=0.0, nbs=64, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, bgr=0.0, mosaic=1.0, mixup=0.0, copy_paste=0.0, auto_augment=randaugment, erasing=0.4, crop_fraction=1.0, cfg=None, tracker=botsort.yaml, save_dir=runs/detect/train104
Overriding model.yaml nc=80 with nc=4
                   from  n    params  module                                       arguments
  0                  -1  1       464  ultralytics.nn.modules.conv.Conv             [3, 16, 3, 2]
  1                  -1  1      4672  ultralytics.nn.modules.conv.Conv             [16, 32, 3, 2]
  2                  -1  1      7360  ultralytics.nn.modules.block.C2f             [32, 32, 1, True]
  3                  -1  1     18560  ultralytics.nn.modules.conv.Conv             [32, 64, 3, 2]
  4                  -1  2     49664  ultralytics.nn.modules.block.C2f             [64, 64, 2, True]
  5                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]
  6                  -1  2    197632  ultralytics.nn.modules.block.C2f             [128, 128, 2, True]
  7                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]
  8                  -1  1    460288  ultralytics.nn.modules.block.C2f             [256, 256, 1, True]
  9                  -1  1    164608  ultralytics.nn.modules.block.SPPF            [256, 256, 5]
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 12                  -1  1    148224  ultralytics.nn.modules.block.C2f             [384, 128, 1]
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 15                  -1  1     37248  ultralytics.nn.modules.block.C2f             [192, 64, 1]
 16                  -1  1     36992  ultralytics.nn.modules.conv.Conv             [64, 64, 3, 2]
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 18                  -1  1    123648  ultralytics.nn.modules.block.C2f             [192, 128, 1]
 19                  -1  1    147712  ultralytics.nn.modules.conv.Conv             [128, 128, 3, 2]
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 21                  -1  1    493056  ultralytics.nn.modules.block.C2f             [384, 256, 1]
 22        [15, 18, 21]  1    752092  ultralytics.nn.modules.head.Detect           [4, [64, 128, 256]]
Model summary: 225 layers, 3011628 parameters, 3011612 gradients, 8.2 GFLOPs
Transferred 319/355 items from pretrained weights
[34m[1mTensorBoard: [39m[22mStart with 'tensorboard --logdir runs/detect/train104', view at http://localhost:6006/
Freezing layer 'model.22.dfl.conv.weight'
[34m[1mAMP: [39m[22mrunning Automatic Mixed Precision (AMP) checks with YOLOv8n...
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mtrain: [39m[22mScanning /home/ubuntu/文档/GitHub/DL大作业/datasets/content/labels/train.cache... 82085 images, 1706 backgrounds, 0 corrupt: 100%|██████████| 83791/83791 [00:00<?, ?it/s]
WARNING ⚠️ no model scale passed. Assuming scale='n'.
New https://pypi.org/project/ultralytics/8.2.34 available 😃 Update with 'pip install -U ultralytics'
Ultralytics YOLOv8.2.31 🚀 Python-3.10.14 torch-2.3.1+cu121 CUDA:0 (NVIDIA P102-100, 10150MiB)
[34m[1mengine/trainer: [39m[22mtask=detect, mode=train, model=./yolov8n.pt, data=/home/ubuntu/文档/GitHub/DL大作业/ua-dataset.yaml, epochs=5, time=None, patience=100, batch=16, imgsz=640, save=True, save_period=-1, cache=False, device=None, workers=8, project=None, name=train105, exist_ok=False, pretrained=True, optimizer=Lion, verbose=True, seed=0, deterministic=True, single_cls=False, rect=False, cos_lr=False, close_mosaic=10, resume=False, amp=True, fraction=1.0, profile=False, freeze=None, multi_scale=False, overlap_mask=True, mask_ratio=4, dropout=0.0, val=True, split=val, save_json=False, save_hybrid=False, conf=None, iou=0.7, max_det=300, half=False, dnn=False, plots=True, source=None, vid_stride=1, stream_buffer=False, visualize=False, augment=False, agnostic_nms=False, classes=None, retina_masks=False, embed=None, show=False, save_frames=False, save_txt=False, save_conf=False, save_crop=False, show_labels=True, show_conf=True, show_boxes=True, line_width=None, format=torchscript, keras=False, optimize=False, int8=False, dynamic=False, simplify=False, opset=None, workspace=4, nms=False, lr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=7.5, cls=0.5, dfl=1.5, pose=12.0, kobj=1.0, label_smoothing=0.0, nbs=64, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, bgr=0.0, mosaic=1.0, mixup=0.0, copy_paste=0.0, auto_augment=randaugment, erasing=0.4, crop_fraction=1.0, cfg=None, tracker=botsort.yaml, save_dir=runs/detect/train105
Overriding model.yaml nc=80 with nc=4
                   from  n    params  module                                       arguments
  0                  -1  1       464  ultralytics.nn.modules.conv.Conv             [3, 16, 3, 2]
  1                  -1  1      4672  ultralytics.nn.modules.conv.Conv             [16, 32, 3, 2]
  2                  -1  1      7360  ultralytics.nn.modules.block.C2f             [32, 32, 1, True]
  3                  -1  1     18560  ultralytics.nn.modules.conv.Conv             [32, 64, 3, 2]
  4                  -1  2     49664  ultralytics.nn.modules.block.C2f             [64, 64, 2, True]
  5                  -1  1     73984  ultralytics.nn.modules.conv.Conv             [64, 128, 3, 2]
  6                  -1  2    197632  ultralytics.nn.modules.block.C2f             [128, 128, 2, True]
  7                  -1  1    295424  ultralytics.nn.modules.conv.Conv             [128, 256, 3, 2]
  8                  -1  1    460288  ultralytics.nn.modules.block.C2f             [256, 256, 1, True]
  9                  -1  1    164608  ultralytics.nn.modules.block.SPPF            [256, 256, 5]
 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 11             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 12                  -1  1    148224  ultralytics.nn.modules.block.C2f             [384, 128, 1]
 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']
 14             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 15                  -1  1     37248  ultralytics.nn.modules.block.C2f             [192, 64, 1]
 16                  -1  1     36992  ultralytics.nn.modules.conv.Conv             [64, 64, 3, 2]
 17            [-1, 12]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 18                  -1  1    123648  ultralytics.nn.modules.block.C2f             [192, 128, 1]
 19                  -1  1    147712  ultralytics.nn.modules.conv.Conv             [128, 128, 3, 2]
 20             [-1, 9]  1         0  ultralytics.nn.modules.conv.Concat           [1]
 21                  -1  1    493056  ultralytics.nn.modules.block.C2f             [384, 256, 1]
 22        [15, 18, 21]  1    752092  ultralytics.nn.modules.head.Detect           [4, [64, 128, 256]]
Model summary: 225 layers, 3011628 parameters, 3011612 gradients, 8.2 GFLOPs
Transferred 319/355 items from pretrained weights
[34m[1mTensorBoard: [39m[22mStart with 'tensorboard --logdir runs/detect/train105', view at http://localhost:6006/
Freezing layer 'model.22.dfl.conv.weight'
[34m[1mAMP: [39m[22mrunning Automatic Mixed Precision (AMP) checks with YOLOv8n...
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mtrain: [39m[22mScanning /home/ubuntu/文档/GitHub/DL大作业/datasets/content/labels/train.cache... 82085 images, 1706 backgrounds, 0 corrupt: 100%|██████████| 83791/83791 [00:00<?, ?it/s]
[34m[1mval: [39m[22mScanning /home/ubuntu/文档/GitHub/DL大作业/datasets/content/labels/val.cache... 56166 images, 174 backgrounds, 0 corrupt: 100%|██████████| 56340/56340 [00:00<?, ?it/s]
Plotting labels to runs/detect/train105/labels.jpg...
[34m[1moptimizer:[39m[22m Lion(lr=0.01, momentum=0.937) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)
        1/5      2.77G      1.251      3.761      1.162        178        640:   0%|          | 0/5237 [00:00<?, ?it/s]
[34m[1mTensorBoard: [39m[22mmodel graph visualization added ✅
Image sizes 640 train, 640 val
Using 8 dataloader workers
Logging results to [1mruns/detect/train105
Starting training for 5 epochs...



























































































































































































































































































































































































































































































































































































































































        1/5      2.94G     0.9975     0.8795     0.9685        207        640: 100%|██████████| 5237/5237 [21:12<00:00,  4.11it/s]


















































































































































































































































































































































                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 1761/1761 [11:18<00:00,  2.60it/s]
                   all      56340     675741      0.438     0.0879      0.164     0.0775
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size





























































































































































































































































































































































































































































































































































































































        2/5      3.39G     0.8398     0.5777     0.9164        211        640: 100%|██████████| 5237/5237 [20:14<00:00,  4.31it/s]

















































































































































































                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 1761/1761 [05:53<00:00,  4.99it/s]
                   all      56340     675741      0.425      0.313      0.315      0.209
  0%|          | 0/5237 [00:00<?, ?it/s]



















































































































































































































































































































































































































































































































































































































        3/5      3.15G     0.7846     0.5021     0.8998        254        640: 100%|██████████| 5237/5237 [19:52<00:00,  4.39it/s]















































































































































































                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 1761/1761 [05:50<00:00,  5.02it/s]
                   all      56340     675741      0.533      0.414      0.476      0.337
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size















































































































































































































































































































































































































































































































































































































        4/5      3.14G      0.753     0.4608     0.8896        223        640: 100%|██████████| 5237/5237 [19:46<00:00,  4.41it/s]












































































































































































                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 1761/1761 [05:44<00:00,  5.12it/s]
                   all      56340     675741      0.539       0.58      0.552      0.404
        5/5      2.86G     0.7482      0.455     0.8838        268        640:   0%|          | 8/5237 [00:01<19:15,  4.53it/s]















































































































































































































































































































































































































































































































































































































        5/5      2.87G     0.7332     0.4375     0.8838        184        640: 100%|██████████| 5237/5237 [19:45<00:00,  4.42it/s]










































































































































































                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 1761/1761 [05:41<00:00,  5.15it/s]
                   all      56340     675741      0.622      0.583      0.581      0.427
5 epochs completed in 2.287 hours.
Optimizer stripped from runs/detect/train105/weights/last.pt, 6.2MB
Optimizer stripped from runs/detect/train105/weights/best.pt, 6.2MB
Validating runs/detect/train105/weights/best.pt...
Ultralytics YOLOv8.2.31 🚀 Python-3.10.14 torch-2.3.1+cu121 CUDA:0 (NVIDIA P102-100, 10150MiB)
Model summary (fused): 168 layers, 3006428 parameters, 0 gradients, 8.1 GFLOPs






























































































































































































































                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|██████████| 1761/1761 [07:24<00:00,  3.96it/s]
                   all      56340     675741      0.628      0.582      0.582      0.426
                 truck      15956      16914      0.504      0.338      0.312       0.19
                   car      55763     548528      0.714      0.714      0.749      0.562
                   van      23507      38516      0.571      0.503      0.483      0.385
                   bus      30921      71783      0.721      0.774      0.783      0.569
Speed: 1.0ms preprocess, 1.6ms inference, 0.0ms loss, 0.8ms postprocess per image
Results saved to [1mruns/detect/train105